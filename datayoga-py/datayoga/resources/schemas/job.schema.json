{
  "title": "Job",
  "description": "Job descriptor",
  "type": "array",
  "items": {
    "type": "object",
    "properties": {
      "uses": {
        "description": "Block type",
        "type": "string"
      },
      "with": {
        "description": "Properties",
        "type": ["object", "array"]
      },
      "cached": {
        "description": "Caching indication",
        "type": ["object", "boolean"],
        "properties": {
          "expiry": {
            "type": ["number"],
            "description": "expiry in seconds",
            "title": "maximum time to expiry of the cache entry"
          }
        }
      },
      "processing": {
        "description": "Processing strategy",
        "type": ["string"],
        "enum": ["sequential","continuous","parallel_async","multiprocess"]
      }
    },
    "additionalProperties": false,
    "required": ["uses", "with"],
    "examples": [
      [
        {
          "uses": "read_csv",
          "with": {
            "file": "employees.csv",
            "batch_size": 2500
          }
        },
        {
          "uses": "add_field",
          "with": {
            "field": "full_name",
            "language": "jmespath",
            "expression": "concat([capitalize(fname), ' ' , capitalize(lname)])"
          }
        },
        {
          "uses": "map",
          "with": {
            "expression": {
              "id": "id",
              "full_name": "full_name",
              "country": "country_code || ' - ' || UPPER(country_name)",
              "gender": "gender"
            }
          }
        },
        {
          "uses": "write_redis",
          "with": {
            "connection": "cache",
            "command": "HSET",
            "key_field": "id"
          }
        }
      ]
    ]
  }
}
